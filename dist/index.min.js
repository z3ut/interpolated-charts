!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("d3")):"function"==typeof define&&define.amd?define(["d3"],e):"object"==typeof exports?exports["interpolated-charts"]=e(require("d3")):t["interpolated-charts"]=e(t.d3)}(this,function(t){return function(t){function e(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=9)}([function(e,n){e.exports=t},function(t,e,n){"use strict";function r(){function t(){var t=n[r];return r=(r+1)%n.length,{value:t,done:!1}}function e(t){return arguments.length?(n=t,r=0,this):n}var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,r=0;return{next:t,schema:e}}Object.defineProperty(e,"__esModule",{value:!0});var a=["#6aedc7","#39c2c9","#ffce00","#ffa71a","#f866b9","#998ce3"];e.colorProvider=r,e.defaultColorSchema=a},function(t,e,n){"use strict";function r(){function t(t){var e=Date.now(),i=e-o;if(o&&i<r)return a&&clearTimeout(a),void(a=setTimeout(n.bind(null,t),r-i));n(t)}function e(){a&&clearTimeout(a)}function n(t){o=Date.now(),t()}var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,a=void 0,o=void 0;return{call:t,clear:e}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function a(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function o(){function t(a){a.each(function(a){X=t.chartWidth(),G=t.chartHeight(),v(this),e(a),n(),r(),o(),i(),l(),d(),g()})}function e(t){Z=t.map(function(t){return t.color=t.color||$.next().value,t.segregatedData=A(t.data),t.chartDiapasons=_(t.data),t})}function n(){var t,e=(t=[]).concat.apply(t,a(Z.map(function(t){return t.data}))),n=e.map(function(t){return t.date}),r=e.map(function(t){return t.value}),o=c.min(n),i=c.max(n),u=c.min(r),l=c.max(r);N=c.scaleTime().domain([o,i]).range([0,X]);var s=.05*(l-u);U=c.scaleLinear().domain([u-s,l+s]).range([G,0])}function r(){J=c.axisBottom(N),B&&J.tickFormat(B),K=c.axisLeft(U),W&&K.tickFormat(W)}function o(){S.select(".x-axis-container").append("g").classed("x-axis",!0).attr("transform","translate(0, "+G+")").call(J),S.select(".y-axis-container").append("g").classed("y-axis",!0).call(K)}function i(){S.select(".grid-container").selectAll(".horizontal-grid-line").data(U.ticks()).enter().append("line").classed("horizontal-grid-line",!0).attr("x1",0).attr("x2",X).attr("y1",function(t){return U(t)}).attr("y2",function(t){return U(t)}),S.select(".grid-container").selectAll(".vertical-grid-line").data(N.ticks()).enter().append("line").classed("vertical-grid-line",!0).attr("x1",function(t){return N(t)}).attr("x2",function(t){return N(t)}).attr("y1",0).attr("y2",G)}function l(){var t=c.line().curve(R).defined(function(t){return t}).x(function(t){return N(t.date)}).y(function(t){return U(t.value)}),e=S.select(".data-lines-container").selectAll(".line").data(Z.reverse());e.enter().append("path").classed("line",!0).style("stroke-width",2).style("fill","none").merge(e).style("stroke",function(t){return t.color}).attr("d",function(e){return t(e.segregatedData)}),e.exit().remove()}function d(){var t=S.append("rect").style("fill","white").attr("width",X).attr("height",G).attr("transform","translate("+E.left+", "+E.top+")").attr("x",0).attr("y",0);t.transition().duration(1e3).ease(c.easeQuadInOut).attr("x",X).on("end",function(){return t.remove()})}function v(t){S||(S=c.select(t).append("svg").classed("line-chart",!0),p()),S.attr("width",D).attr("height",j)}function p(){var t=S.append("g").classed("container-group",!0).attr("transform","translate("+E.left+", "+E.top+")");t.append("g").classed("grid-container",!0),t.append("g").classed("x-axis-container",!0),t.append("g").classed("y-axis-container",!0),t.append("g").classed("data-lines-container",!0),t.append("g").classed("metadata-container",!0)}function g(){S.on("mousemove",m),S.on("mouseenter",M),S.on("mouseleave",k),S.on("click",x)}function m(){var t=c.mouse(this);tt.call(y.bind(this,t))}function y(t){var e=b.apply(void 0,a(t));et.call(h.chartMouseMove,this,e)}function x(){var t=b.apply(void 0,a(c.mouse(this)));et.call(h.chartMouseClick,this,t)}function M(){et.call.apply(et,[h.chartMouseEnter].concat(a(c.mouse(this))))}function k(){tt.clear(),et.call.apply(et,[h.chartMouseLeave].concat(a(c.mouse(this))))}function b(t,e){var n=function(t,e,n){return Math.min(Math.max(t,e),n)};t=n(t-E.left,0,X),e=n(e-E.top,0,G);var r=w(t);return{x:t,y:e,selectedDate:N.invert(t),data:r}}function w(t){var e=[],n=N.invert(t);return S.selectAll(".line").each(function(r){var a=r.data.reduce(function(t,e){return!e||Math.abs(t.date-n)<Math.abs(e.date-n)?t:e});if(r.chartDiapasons.some(function(t){return t.from<=n&&n<=t.to})){var o=(0,s.default)(this,t,I,Y,nt[r.name]),i=o.y,c=o.pathLength;a.x=N(a.date),a.y=U(a.value),a.interpolatedX=t,a.interpolatedY=i,a.interpolatedDate=N.invert(t),a.interpolatedValue=U.invert(i),a.name=r.name,a.color=r.color,e.push(a),nt[r.name]=c}}),e}function _(t){if(!Array.isArray(t)||!t.length)return[];var e=[];return t.reduce(function(t,n){return n.date-t.date<F&&e.push({from:t.date,to:n.date}),n}),e}function A(t){var e=[];return t.forEach(function(t,n,r){if(0===n||n===r.length-1)return void e.push(r[n]);var a=function(t,e){return t.date-e.date>F};a(r[n],r[n-1])&&e.push(null),e.push(r[n]),a(r[n+1],r[n])&&e.push(null)}),e}var T=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},O=T.width,D=void 0===O?700:O,P=T.height,j=void 0===P?500:P,C=T.margin,E=void 0===C?{top:20,right:30,bottom:40,left:40}:C,L=T.maxTimeRangeDifferenceToDraw,F=void 0===L?1296e5:L,B=T.xAxisTimeFormat,W=T.yAxisValueFormat,H=T.curve,R=void 0===H?c.curveBasis:H,z=T.interpolationMaxIterationCount,I=void 0===z?25:z,V=T.interpolationAccuracy,Y=void 0===V?.005:V,q=T.mouseMoveTimeTreshold,Q=void 0===q?20:q,S=void 0,X=void 0,G=void 0,J=void 0,K=void 0,N=void 0,U=void 0,Z=void 0,$=(0,u.colorProvider)(),tt=(0,f.default)(Q),et=c.dispatch(h.chartMouseEnter,h.chartMouseLeave,h.chartMouseMove,h.chartMouseClick),nt={};return t.width=function(t){return arguments.length?(D=t,this):D},t.height=function(t){return arguments.length?(j=t,this):j},t.margin=function(t){return arguments.length?(E=t,this):E},t.on=function(){return et.on.apply(et,arguments),this},t.maxTimeRangeDifferenceToDraw=function(t){return arguments.length?(F=t,this):F},t.xAxisTimeFormat=function(t){return arguments.length?(B=t,this):B},t.yAxisValueFormat=function(t){return arguments.length?(W=t,this):W},t.curve=function(t){return arguments.length?(R=t,this):R},t.interpolationMaxIterationCount=function(t){return arguments.length?(I=t,this):I},t.interpolationAccuracy=function(t){return arguments.length?(Y=t,this):Y},t.mouseMoveTimeTreshold=function(t){return arguments.length?(Q=t,tt.clear(),tt=(0,f.default)(Q),this):Q},t.chartHeight=function(){return j-E.top-E.bottom},t.chartWidth=function(){return D-E.left-E.right},t}Object.defineProperty(e,"__esModule",{value:!0}),e.chartEvents=e.line=void 0;var i=n(0),c=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(i),u=n(1),l=n(10),s=r(l),d=n(2),f=r(d),h={chartMouseEnter:"chartMouseEnter",chartMouseLeave:"chartMouseLeave",chartMouseMove:"chartMouseMove",chartMouseClick:"chartMouseClick"};e.line=o,e.chartEvents=h},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function a(){function t(r){r.each(function(r){I=t.chartWidth(),V=t.chartHeight(),f(this),e(r),n(),a(),v(),o(),u(),d(),p()})}function e(t){S=w(t),Q=t}function n(){var t=Q.map(function(t){return t.date}),e=i.min(t),n=i.max(t);q=i.scaleTime().domain([e,n]).range([0,I])}function a(){Y=i.axisBottom(q),W&&Y.tickFormat(W)}function o(){z.select(".x-axis-container").append("g").classed("x-axis",!0).attr("transform","translate(0, "+V+")").call(Y)}function u(){var t=z.select(".data-stacks-container").selectAll(".stack").data(S);t.enter().append("rect").classed("stack",!0).style("fill",function(t){return t.color}).merge(t).attr("x",function(t){return Math.trunc(q(t.from))}).attr("y",0).attr("width",function(t){return Math.ceil(q(t.to)-q(t.from))}).attr("height",V),t.exit().remove()}function d(){var t=z.append("rect").style("fill","white").attr("width",I).attr("height",V).attr("transform","translate("+C.left+", "+C.top+")").attr("x",0).attr("y",0);t.transition().duration(1e3).ease(i.easeQuadInOut).attr("x",I).on("end",function(){return t.remove()})}function f(t){z||(z=i.select(t).append("svg").classed("stack-bar",!0),h()),z.attr("width",O).attr("height",P)}function h(){var t=z.append("g").classed("container-group",!0).attr("transform","translate("+C.left+", "+C.top+")");t.append("g").classed("background-container",!0),t.append("g").classed("x-axis-container",!0),t.append("g").classed("data-stacks-container",!0),t.append("g").classed("metadata-container",!0)}function v(){z.select(".background-container").append("rect").attr("x",0).attr("y",0).attr("width",I).attr("height",V).attr("fill",L).classed("background",!0)}function p(){z.on("mousemove",g),z.on("mouseenter",x),z.on("mouseleave",M),z.on("click",y)}function g(){var t=i.mouse(this);J.call(m.bind(this,t))}function m(t){var e=k.apply(void 0,r(t));K.call(s.chartMouseMove,this,e)}function y(){var t=k.apply(void 0,r(i.mouse(this)));K.call(s.chartMouseClick,this,t)}function x(){K.call.apply(K,[s.chartMouseEnter].concat(r(i.mouse(this))))}function M(){J.clear(),K.call.apply(K,[s.chartMouseLeave].concat(r(i.mouse(this))))}function k(t,e){var n=function(t,e,n){return Math.min(Math.max(t,e),n)};t=n(t-C.left,0,I),e=n(e-C.top,0,V);var r=b(t);return{x:t,y:e,selectedDate:q.invert(t),data:r}}function b(t){var e=q.invert(t),n=S.find(function(t){return t.from<=e&&e<=t.to});return n&&(n.interpolatedDate=e),n?[n]:[]}function w(t){if(!Array.isArray(t)||!t.length)return[];var e=[];return t.reduce(function(t,n){var r=new Date((t.date.getTime()+n.date.getTime())/2),a=function(t){return{color:_(t),name:t.name,value:t.value,from:t.date,to:t.date}},o=a(t),i=a(n);return o.to=Math.min(new Date(t.date.getTime()+B),r),i.from=Math.max(new Date(n.date.getTime()-B),r),e.push(o,i),n}),e}function _(t){return t.color?t.color:G[t.name]?G[t.name]:(G[t.name]=X.next().value,G[t.name])}var A=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},T=A.width,O=void 0===T?700:T,D=A.height,P=void 0===D?120:D,j=A.margin,C=void 0===j?{top:20,right:30,bottom:40,left:40}:j,E=A.backgroundColor,L=void 0===E?"#CCC":E,F=A.maxTimeRangeDifferenceToDraw,B=void 0===F?1296e5:F,W=A.xAxisTimeFormat,H=A.mouseMoveTimeTreshold,R=void 0===H?20:H,z=void 0,I=void 0,V=void 0,Y=void 0,q=void 0,Q=void 0,S=void 0,X=(0,c.colorProvider)(),G={},J=(0,l.default)(R),K=i.dispatch(s.chartMouseEnter,s.chartMouseLeave,s.chartMouseMove,s.chartMouseClick);return t.width=function(t){return arguments.length?(O=t,this):O},t.height=function(t){return arguments.length?(P=t,this):P},t.margin=function(t){return arguments.length?(C=t,this):C},t.backgroundColor=function(t){return arguments.length?(L=t,this):L},t.on=function(){return K.on.apply(K,arguments),this},t.maxTimeRangeDifferenceToDraw=function(t){return arguments.length?(B=t,this):B},t.xAxisTimeFormat=function(t){return arguments.length?(W=t,this):W},t.mouseMoveTimeTreshold=function(t){return arguments.length?(R=t,J.clear(),J=(0,l.default)(R),this):R},t.chartHeight=function(){return P-C.top-C.bottom},t.chartWidth=function(){return O-C.left-C.right},t}Object.defineProperty(e,"__esModule",{value:!0}),e.chartEvents=e.stackBar=void 0;var o=n(0),i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(o),c=n(1),u=n(2),l=function(t){return t&&t.__esModule?t:{default:t}}(u),s={chartMouseEnter:"chartMouseEnter",chartMouseLeave:"chartMouseLeave",chartMouseMove:"chartMouseMove",chartMouseClick:"chartMouseClick"};e.stackBar=a,e.chartEvents=s},function(t,e,n){"use strict";function r(){function t(t){t.each(function(){e(this)})}function e(t){y||(y=o.select(t).append("g").classed("marker-container",!0))}var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.cx,a=void 0===r?function(t){return t.interpolatedX||t.x}:r,i=n.cy,c=void 0===i?function(t){return t.interpolatedY||t.y}:i,u=n.radius,l=void 0===u?function(){return 5}:u,s=n.fill,d=void 0===s?function(){return"white"}:s,f=n.stroke,h=void 0===f?function(t){return t.color||"red"}:f,v=n.strokeWidth,p=void 0===v?function(){return 2}:v,g=n.sort,m=void 0===g?function(){return 0}:g,y=void 0;return t.remove=function(){return y.selectAll(".marker").remove(),this},t.show=function(t){var e=t.data,n=y.selectAll(".marker").data(e.slice().sort(m).reverse());return n.enter().append("circle").classed("marker",!0).merge(n).attr("cx",function(t){return a(t)}).attr("cy",function(t){return c(t)}).attr("r",function(t){return l(t)}).style("fill",function(t){return d(t)}).style("stroke",function(t){return h(t)}).style("stroke-width",function(t){return p(t)}),n.exit().remove(),this},t.cx=function(t){return arguments.length?(a=t,this):a},t.cy=function(t){return arguments.length?(c=t,this):c},t.radius=function(t){return arguments.length?(l=t,this):l},t.fill=function(t){return arguments.length?(d=t,this):d},t.stroke=function(t){return arguments.length?(h=t,this):h},t.strokeWidth=function(t){return arguments.length?(p=t,this):p},t.sort=function(t){return arguments.length?(m=t,this):m},t}Object.defineProperty(e,"__esModule",{value:!0});var a=n(0),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(a);e.default=r},function(t,e,n){"use strict";function r(){function t(t){t.each(function(){e(this)})}function e(t){w||(w=o.select(t).append("g").classed("tooltip-container",!0))}function n(t,e,n){var r=t.append("xhtml:div").append("div").classed("tooltip-container",!0);r.append("div").classed("tooltip-header",!0).append("p").html(g(e,n)),r.append("hr"),n.slice().sort(b).reverse().forEach(function(t){var e=r.append("div").classed("topic",!0);e.append("div").classed("circle",!0).style("background-color",t.color),e.append("div").classed("topic-name",!0).html(y(t)),e.append("div").classed("topic-value",!0).html(M(t))});var a=r.node().getBoundingClientRect().height;return{div:r,divHeight:a}}var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=r.chartHeight,i=void 0===a?440:a,c=r.chartWidth,u=void 0===c?700:c,l=r.tooltipWidth,s=void 0===l?220:l,d=r.horizontalMouseMargin,f=void 0===d?40:d,h=r.verticalBorderMargin,v=void 0===h?10:h,p=r.headerFormatter,g=void 0===p?function(t){return o.timeFormat("%Y-%d-%m %H:%M:%S")(t)}:p,m=r.topicFormatter,y=void 0===m?function(t){return t.name}:m,x=r.valueFormatter,M=void 0===x?function(t){return o.format(".1f")(t.interpolatedValue)}:x,k=r.sort,b=void 0===k?function(){return 0}:k,w=void 0;return t.remove=function(){return w.select(".tooltip").remove(),this},t.show=function(e){var r=e.x,a=e.y,o=e.selectedDate,c=e.data;t.remove(),w.append("g").classed("tooltip",!0).append("rect").attr("width",s);var l=w.select(".tooltip").append("foreignObject").classed("foreign-object",!0).attr("width",s),d=n(l,o,c),h=d.divHeight;w.select(".tooltip foreignObject").attr("height",h),w.select(".tooltip rect").attr("height",h);var p=r>u/2?r-s-f:r+f,g=a+h>i-v?i-h-v:a;return w.select(".tooltip").attr("transform","translate("+p+", "+g+")"),this},t.chartHeight=function(t){return arguments.length?(i=t,this):i},t.chartWidth=function(t){return arguments.length?(u=t,this):u},t.tooltipWidth=function(t){return arguments.length?(s=t,this):s},t.horizontalMouseMargin=function(t){return arguments.length?(f=t,this):f},t.verticalBorderMargin=function(t){return arguments.length?(v=t,this):v},t.headerFormatter=function(t){return arguments.length?(g=t,this):g},t.topicFormatter=function(t){return arguments.length?(y=t,this):y},t.valueFormatter=function(t){return arguments.length?(M=t,this):M},t.sort=function(t){return arguments.length?(b=t,this):b},t}Object.defineProperty(e,"__esModule",{value:!0});var a=n(0),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(a);e.default=r},function(t,e,n){"use strict";function r(){function t(t){t.each(function(){e(this)})}function e(t){i||(i=o.select(t).append("g").classed("divider-container",!0)),i.append("line").classed("divider",!0).attr("y1",0).attr("y2",a)}var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.height,a=void 0===r?440:r,i=void 0;return t.remove=function(){return i.style("display","none"),this},t.show=function(){return i.style("display","block"),this},t.update=function(t){var e=t.x;return i.select(".divider").attr("x1",e).attr("x2",e),this},t.height=function(t){return arguments.length?(a=t,this):a},t}Object.defineProperty(e,"__esModule",{value:!0});var a=n(0),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(a);e.default=r},function(t,e){},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.tooltip=e.markers=e.verticalDivider=e.chartEvents=e.stackBar=e.line=void 0;var a=n(3),o=n(4),i=n(7),c=r(i),u=n(5),l=r(u),s=n(6),d=r(s);n(8),e.line=a.line,e.stackBar=o.stackBar,e.chartEvents=a.chartEvents,e.verticalDivider=c.default,e.markers=l.default,e.tooltip=d.default},function(t,e,n){"use strict";function r(t,e,n,r,a){var o=t.getBBox();if(e<o.x||o.x+o.width<e)return{};var i=0,c=t.getTotalLength();if("number"==typeof a){var u=a-20,l=a+20;t.getPointAtLength(u).x<e&&(i=u),t.getPointAtLength(l).x>e&&(c=l)}for(var s=(i+c)/2,d=0,f=t.getPointAtLength(s);d<n&&Math.abs(f.x-e)>r;)s=(i+c)/2,f=t.getPointAtLength(s),f.x<e?i=s:c=s,d++;return{y:f.y,pathLength:s}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=r}])});